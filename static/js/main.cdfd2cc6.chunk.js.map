{"version":3,"sources":["components/CounterLabel/index.module.css","components/Counter/index.module.css","components/Counter/index.jsx","components/Loader/index.jsx","components/CounterLabel/index.jsx","constants/apiConstants.js","apis/index.js","utils/helper/index.js","utils/helper/networkQueuer.js","App.jsx","index.js","components/Loader/index.module.css"],"names":["module","exports","Counter","value","onChange","className","styles","counterContainer","counterItem","counterButton","onClick","counterItemText","counterInput","e","target","Loader","isLoading","loaderContainer","loaderItem","loader","loaderItemText","CounterLabel","container","URL","get","put","fetchCounter","a","axios","res","status","Error","data","putCounter","amati","networkQueuer","onFinish","addRequest","req","onSuccess","onFailure","queue","push","isResolving","run","addCallbackMethod","callback","canRunNext","shift","length","this","App","useState","dispatchSetCount","fetchedValue","dispatchSetFetchedCount","loading","dispatchLoader","dispatchStartLoader","useCallback","dispatchEndLoader","syncValue","console","log","useEffect","onFinishLoading","uploadValue","newValue","parseInt","process","MAX_VALUE","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.cdfd2cc6.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"CounterLabel_container__1I2x3\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"counterContainer\":\"Counter_counterContainer__1Zp3W\",\"counterItem\":\"Counter_counterItem__lcAU3\",\"counterItemText\":\"Counter_counterItemText__2eF-r\",\"counterButton\":\"Counter_counterButton__1wcR8\",\"counterInput\":\"Counter_counterInput__19Otq\"};","import React from 'react';\nimport styles from './index.module.css';\nexport const Counter = ({ value, onChange }) => {\n  return (\n    <div className={styles.counterContainer}>\n      <div className={styles.counterItem}>\n        <button\n          className={styles.counterButton}\n          onClick={() => {\n            onChange(value - 1);\n          }}\n        >\n          <span className={styles.counterItemText}>-</span>\n        </button>\n      </div>\n      <div className={styles.counterItem}>\n        <input\n          className={styles.counterInput}\n          value={value}\n          onChange={(e) => {\n            onChange(e.target.value);\n          }}\n        />\n      </div>\n      <div className={styles.counterItem}>\n        <button\n          className={styles.counterButton}\n          onClick={() => {\n            onChange(value - 1 + 2);\n          }}\n        >\n          <span className={styles.counterItemText}>+</span>\n        </button>\n      </div>\n    </div>\n  );\n};\n","import React from 'react';\nimport styles from './index.module.css';\n\nexport const Loader = ({ isLoading }) => {\n  if (!isLoading) return null;\n  return (\n    <div className={styles.loaderContainer}>\n      <div className={styles.loaderItem}>\n        <div className={styles.loader}>\n          <div />\n          <div />\n          <div />\n          <div />\n        </div>\n      </div>\n      <div className={styles.loaderItem}>\n        <p className={styles.loaderItemText}>Saving counter value</p>\n      </div>\n    </div>\n  );\n};\n","import React from 'react';\nimport styles from './index.module.css';\n\nexport const CounterLabel = ({ value }) => {\n  return <div className={styles.container}>Counter Value: {value}</div>;\n};\n","export const endPoint = 'amati';\n\nexport const URL = {\n  get: `https://interview-8e4c5-default-rtdb.firebaseio.com/front-end/${endPoint}.json`,\n  put: 'https://interview-8e4c5-default-rtdb.firebaseio.com/front-end.json',\n};\n","import axios from 'axios';\nimport { URL, endPoint } from '../constants';\n\nexport const fetchCounter = async () => {\n  try {\n    const res = await axios.get(URL.get);\n    if (res.status !== 200) throw new Error('Connection failed');\n    return res.data;\n  } catch (e) {\n    throw e;\n  }\n};\n\nexport const putCounter = async (value) => {\n  try {\n    const res = await axios.put(URL.put, {\n      amati: value,\n    });\n    if (res.status !== 200) throw new Error('Connection failed');\n\n    return res.data;\n  } catch (e) {\n    throw e;\n  }\n};\n","import { NetworkQueuer } from './networkQueuer';\nconst networkQueuer = new NetworkQueuer();\n\nexport { networkQueuer };\n","class NetworkQueuer {\n  constructor(onFinish) {\n    this.queue = [];\n    this.isResolving = false;\n    this.callback = onFinish;\n  }\n\n  addRequest = (req, onSuccess, onFailure) => {\n    this.queue.push({ req, onSuccess, onFailure });\n    if (this.isResolving) return;\n    this.run();\n  };\n\n  addCallbackMethod = (callback) => {\n    this.callback = callback;\n  };\n\n  run = async () => {\n    if (!this.canRunNext()) {\n      this.isResolving = false;\n      this.callback();\n      return;\n    }\n\n    this.isResolving = true;\n    const { req, onSuccess, onFailure } = this.queue.shift();\n\n    try {\n      const res = await req;\n      onSuccess(res);\n    } catch (e) {\n      onFailure(e);\n    }\n\n    this.run();\n  };\n  canRunNext = () => {\n    return this.queue.length > 0;\n  };\n}\n\nexport { NetworkQueuer };\n","import React, { useCallback, useEffect, useState } from 'react';\nimport './App.css';\nimport { Counter, Loader, CounterLabel } from './components';\nimport { fetchCounter, putCounter } from './apis';\nimport { networkQueuer } from './utils';\n\nconst App = () => {\n  const [value, dispatchSetCount] = useState(1);\n  const [fetchedValue, dispatchSetFetchedCount] = useState(1);\n  const [loading, dispatchLoader] = useState(false);\n\n  const dispatchStartLoader = useCallback(\n    () => dispatchLoader(true),\n    [dispatchLoader]\n  );\n  const dispatchEndLoader = useCallback(\n    () => dispatchLoader(false),\n    [dispatchLoader]\n  );\n\n  const syncValue = useCallback(async () => {\n    try {\n      dispatchStartLoader();\n      let res = await fetchCounter();\n      res = res || 1;\n\n      dispatchSetCount(res);\n      dispatchSetFetchedCount(res);\n\n      dispatchEndLoader();\n    } catch (e) {\n      dispatchEndLoader();\n      console.log(e);\n    }\n  }, [dispatchStartLoader, dispatchSetCount, dispatchEndLoader]);\n\n  useEffect(() => {\n    syncValue();\n  }, [syncValue]);\n\n  const onFinishLoading = useCallback(() => {\n    dispatchEndLoader();\n  }, [dispatchEndLoader]);\n\n  useEffect(() => {\n    networkQueuer.addCallbackMethod(onFinishLoading);\n  }, [onFinishLoading]);\n\n  const uploadValue = async (value) => {\n    dispatchStartLoader();\n    const onSuccess = (res) => {\n      dispatchSetFetchedCount(res['amati'] ?? 1);\n      // dispatchEndLoader();\n    };\n    const onFailure = () => {\n      // dispatchEndLoader();\n    };\n    networkQueuer.addRequest(putCounter(value), onSuccess, onFailure);\n  };\n\n  const handleChange = (newValue) => {\n    let res = parseInt(newValue || 0);\n    const MAX_VALUE = process.env.MAX_VALUE || 1000;\n    if (res > MAX_VALUE) return;\n    dispatchSetCount(res);\n\n    uploadValue(res);\n  };\n\n  return (\n    <div className='App'>\n      <div className='container'>\n        <Loader isLoading={loading} />\n        <Counter value={value} onChange={handleChange} />\n        <CounterLabel value={fetchedValue} />\n      </div>\n    </div>\n  );\n};\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"loaderContainer\":\"Loader_loaderContainer__3hB3G\",\"loader\":\"Loader_loader__3o9Lr\",\"loaderItem\":\"Loader_loaderItem__3w9WE\",\"loaderItemText\":\"Loader_loaderItemText__18aAo\"};"],"sourceRoot":""}